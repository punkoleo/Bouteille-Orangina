/*! typestate - v1.0.0 - 2014-05-02
* https://github.com/eonarheim/TypeState
* Copyright (c) 2014 Erik Onarheim; Licensed BSD-2 Clause*/
var TypeState;(function(t){var n=function(){function t(t){this.fsm=t}return t.prototype.to=function(){for(var t=[],n=0;arguments.length-0>n;n++)t[n]=arguments[n+0];this.toStates=t,this.fsm.addTransitions(this)},t.prototype.toAny=function(t){var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(t[r]);this.toStates=n,this.fsm.addTransitions(this)},t}();t.Transitions=n;var r=function(){function t(t,n,r){this.fsm=t,this.from=n,this.to=r}return t}();t.TransitionFunction=r;var i=function(){function t(t){this._transitionFunctions=[],this._onCallbacks={},this._exitCallbacks={},this._enterCallbacks={},this.currentState=t,this._startState=t}return t.prototype.addTransitions=function(t){var n=this;t.fromStates.forEach(function(i){t.toStates.forEach(function(t){i===t||n._validTransition(i,t)||n._transitionFunctions.push(new r(n,i,t))})})},t.prototype.on=function(t,n){var r=""+t;return this._onCallbacks[r]||(this._onCallbacks[r]=[]),this._onCallbacks[r].push(n),this},t.prototype.onEnter=function(t,n){var r=""+t;return this._enterCallbacks[r]||(this._enterCallbacks[r]=[]),this._enterCallbacks[r].push(n),this},t.prototype.onExit=function(t,n){var r=""+t;return this._exitCallbacks[r]||(this._exitCallbacks[r]=[]),this._exitCallbacks[r].push(n),this},t.prototype.from=function(){for(var t=[],r=0;arguments.length-0>r;r++)t[r]=arguments[r+0];var i=new n(this);return i.fromStates=t,i},t.prototype.fromAny=function(t){var r=[];for(var i in t)t.hasOwnProperty(i)&&r.push(t[i]);var s=new n(this);return s.fromStates=r,s},t.prototype._validTransition=function(t,n){return this._transitionFunctions.some(function(r){return r.from===t&&r.to===n})},t.prototype.canGo=function(t){return this.currentState===t||this._validTransition(this.currentState,t)},t.prototype.go=function(t){if(!this.canGo(t))throw Error("Error no transition function exists from state "+(""+this.currentState)+" to "+(""+t));this._transitionTo(t)},t.prototype.reset=function(){this.currentState=this._startState},t.prototype._transitionTo=function(t){var n=this;this._exitCallbacks[""+this.currentState]||(this._exitCallbacks[""+this.currentState]=[]),this._enterCallbacks[""+t]||(this._enterCallbacks[""+t]=[]),this._onCallbacks[""+t]||(this._onCallbacks[""+t]=[]);var r=this._exitCallbacks[""+this.currentState].reduce(function(r,i){return r&&i.call(n,t)},!0),i=this._enterCallbacks[""+t].reduce(function(t,r){return t&&r.call(n,n.currentState)},!0);if(r&&i){var s=this.currentState;this.currentState=t,this._onCallbacks[""+this.currentState].forEach(function(t){t.call(n,s)})}},t}();t.FiniteStateMachine=i})(TypeState||(TypeState={}));